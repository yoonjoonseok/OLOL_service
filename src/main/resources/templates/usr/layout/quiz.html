<html layout:decorate="~{usr/layout/layout.html}">
<main layout:fragment="main">
    <style>
        .quiz-container {
            position: relative;
            background-color: #388E3C;
            font-size: 20px;
            color: white;
            font-weight: bold;
            height: 150px;
            margin-top: 40px;
            text-align: center;
            font-weight: 300;
        }

        .slide {
            position: absolute;
            left: 0px;
            top: 40px;
            width: 100%;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .active-slide {
            opacity: 1;
            z-index: 2;
        }

        .quiz-ctrl {
            display: flex;
            justify-content: center;
        }

        #next {
            width: 100px;
            height: 30px;
            background-color: #154304;
            color: white;
        }

        #submit {
            width: 100px;
            height: 30px;
            background-color: #154304;
            color: white;
        }

        #previous {
            color: white;
            background-color: #2E7D32;
        }

        #retry {
            color: white;
            background-color: #2E7D32;
        }

    </style>
    <div class="quiz-container">
        <div id="quiz"></div>
    </div>

    <div class="quiz-ctrl">
        <button id="previous" class="btn-gradient red mini"> back</button>
        <button id="next" class="btn-gradient red mini"> next</button>
        <button id="submit" class="btn-gradient red mini"> 결과확인</button>
        <button onclick="location.href='/quiz'" id="retry" class="btn-gradient red mini"> 다시하기</button>

        <div id="result"></div>
    </div>
    <script>
        const quizData = [
            {
                question: '구급의 3대 요소가 아닌 것은?',
                answers: {
                    1: "지혈",
                    2: "쇼크방지",
                    3: "긴급수송",
                    4: "상처보호"
                },
                correct: 3
            },
            {
                question: '세계 최초의 산악회는 영국에서 창립되었다. 이 산악회의 명칭은 무엇인가?',
                answers: {
                    1: '알피인 클럽',
                    2: '알파인 클럽',
                    3: '알프스 클럽',
                    4: '알파스 클럽'
                },
                correct: 2
            },
            {
                question: '다음 중 매듭의 강도가 가장 높은 것은 어느 것인가?',
                answers: {
                    1: '까베스땅',
                    2: '오버핸드 매듭',
                    3: '피셔맨 매듭',
                    4: '8자 매듭'
                },
                correct: 3
            },
            // {
            //     question: '강을 건널 때는 강줄기 방향으로 비스듬히 내려가며 건너야 한다.',
            //     answers: {
            //         1: 'O',
            //         2: 'X'
            //     },
            //     correct: 2
            // },
            {
                question: '배낭을 꾸릴 때 암벽장비 같은 무거운 것은 아래에 넣고 침낭 같이 부피가 크고 가벼운 것은 위에 둔다.',
                answers: {
                    1: 'O',
                    2: 'X'
                },
                correct: 2
            },
            // {
            //     question: '다음 중 비상식량의 조건이 아닌 것은?',
            //     answers: {
            //         1: '무게가 있더라도 열량이 높은 것이 좋다.',
            //         2: '당질을 많이 포함하고 있어야 한다.',
            //         3: '조리하지 않고 바로 섭취할 수 있어야 한다.',
            //         4: '개인별로 휴대하기 좋아야 한다'
            //     },
            //     correct: 1
            // },
            // {
            //     question: '다음 중 개인장비가 아닌 것은?',
            //     answers: {
            //         1: '배낭',
            //         2: '비상약품',
            //         3: '헤드랜턴',
            //         4: '칼'
            //     },
            //     correct: 2
            // },
            // {
            //     question: '다음 중 야영지 고르기로 알맞은 것은?',
            //     answers: {
            //         1: '등산로와 멀리 떨어져 있어야 한다.',
            //         2: '움푹 파인 지대로 눈에 잘 띄지 않는 곳을 선택한다.',
            //         3: '등반에 편리한 곳을 고른다.',
            //         4: '비가 많이 올 때에는 큰 나무 아래로 고른다.'
            //     },
            //     correct: 3
            // },
            // {
            //     question: '등산에서 오르막길을 걷는 방법으로 옳지 않은 것은?',
            //     answers: {
            //         1: '빠른 걸음이 되지 않도록 한다.',
            //         2: '경사가 급할수록 보폭을 좁게 한다.',
            //         3: '몸 전체를 좌우 앞뒤 조금씩 흔드는 기분으로 걸어야 한다.',
            //         4: '급경사에서는 일직선 코스를 잡고 걸어야 한다.'
            //     },
            //     correct: 4
            // },
            //
            // {
            //     question: '겨울철 야영 방법으로 올바르지 않은 것은?',
            //     answers: {
            //         1: '잠자기 전에는 간식을 충분히 섭취한다.',
            //         2: '동사할 가능성이 있으므로 화기를 계속 틀고 잔다.',
            //         3: '잠잘 때에는 등산화를 침낭 속에 품고 잔다.',
            //         4: '조금 춥더라도 자주 환기를 시켜주는 것이 좋다.'
            //     },
            //     correct: 2
            // },
            // {
            //     question: '산행 중 휴식에 관한 설명이다. 틀린 것은?',
            //     answers: {
            //         1: '리더의 지시에 따라 전원이 휴식하고 짐이나 신발 상태를 점검한다.',
            //         2: '리더가 피로를 느끼면 10분 이상 휴식한다.',
            //         3: '보통 30~60분간 걷고 5~10분간 휴식한다.',
            //         4: '가급적 천천히 걷고 휴식 횟수를 적게 한다.'
            //     },
            //     correct: 4
            // },
            {
                question: '1967년 우리나라 최초로 지정된 국립공원 제1호는 어디인가?',
                answers: {
                    1: '지리산',
                    2: '설악산',
                    3: '한라산',
                    4: '태백산'
                },
                correct: 1
            },
            {
                question: '선등자의 루트 선택 방법으로 맞지 않는 것은?',
                answers: {
                    1: '따라 오를 수 있는 코스보다 다소 쉬운 곳을 고른다.',
                    2: '등반 경험이 있는 코스를 고른다.',
                    3: '코스 정찰이 쉽고 하강이 가능한 코스를 고른다.',
                    4: '확보물 설치와 관계없이 고른다.'
                },
                correct: 4
            },

        ]


        const nextBtn = document.getElementById('next');
        const quizDisplay = document.getElementById('quiz');
        const submitBtn = document.getElementById('submit');
        const previousBtn = document.getElementById('previous');
        const retryBtn = document.getElementById('retry');


        let currentSlide = 0;
        const resultDisplay = document.getElementById('result');

        function buildQuiz() {
            let output = [];
            quizData.forEach(
                (currentQuestion, questionNum) => {
                    const answers = [];
                    for (item in currentQuestion.answers) {
                        answers.push(`<label><input type="radio" name="question${questionNum}" value="${item}">
${item} : ${currentQuestion.answers[item]}</label>`);
                    }
                    output.push(`<div class="slide"><div class="question"> ${currentQuestion.question}</div>
                <div class="answer">${answers.join('&nbsp;&nbsp;&nbsp;&nbsp;')}</div></div>`);
                }
            );
            quizDisplay.innerHTML = output.join('</br>');
        }

        function showResult() {
            const answerDisplays = quizDisplay.querySelectorAll('.answer');
            let numCorrect = 0;

            quizData.forEach((currentQuestion, questionNum) => {
                const answerDisplay = answerDisplays[questionNum];
                const selector = `input[name=question${questionNum}]:checked`;
                const userAnswer = (answerDisplay.querySelector(selector) || {}).value;


                if (userAnswer === currentQuestion.correct) {
                    numCorrect++;
                    answerDisplays[questionNum].style.color = 'lightgreen';
                } else {
                    answerDisplays[questionNum].style.color = 'red';
                }
            });


            submitBtn.style.display = 'none';
            resultDisplay.innerHTML = `<a style="color:#333;">${quizData.length}개중에서 ${numCorrect}개 맞추셨습니다. !! 다시하시려면 새고로침을 해주세요 !!</a>`
        }


        function showSlide(n) {
            slides[currentSlide].classList.remove('active-slide');
            slides[n].classList.add('active-slide');
            currentSlide = n;
            if (currentSlide === 0) {
                previousBtn.style.display = 'none';

            } else {
                previousBtn.style.display = 'inline-block';
            }
            if (currentSlide === slides.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-block';

            } else {
                nextBtn.style.display = 'inline-block';
                submitBtn.style.display = 'none';

                if (document.getElementById('retry')) {
                    document.getElementById('retry').style.display = 'none';

                }

            }
        }

        function showNextSlide() {
            showSlide(currentSlide + 1);
        }

        function showPreviousSlide() {
            showSlide(currentSlide - 1);
        }


        buildQuiz();
        const slides = document.querySelectorAll('.slide');
        showSlide(currentSlide);
        previousBtn.addEventListener('click', showPreviousSlide);
        nextBtn.addEventListener('click', showNextSlide);
        submitBtn.addEventListener('click', showResult);
    </script>
</main>
</body>
</html>
